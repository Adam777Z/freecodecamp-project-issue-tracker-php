document.addEventListener("DOMContentLoaded",t=>{if(document.querySelectorAll(".test-form").forEach(t=>{t.addEventListener("submit",t=>{t.preventDefault(),fetch("api/issues/apitest",{method:t.target.getAttribute("method").toUpperCase(),body:new URLSearchParams(new FormData(t.target))}).then(t=>{if(t.ok)return t.json();throw"Error"}).then(e=>{void 0===e.error&&t.target.reset(),document.querySelector("#result-json").textContent=JSON.stringify(e)}).catch(t=>{console.log(t)})})}),null!==document.querySelector("#issue-display")){var e=window.location.pathname.match(/(?:\/.*)*\/(.*)\/$/)[1],s=window.location.pathname.replace(e+"/",""),n=s+"api/issues/"+e;document.querySelector("#project-title").textContent="All issues for: "+e,fetch(n,{method:"GET"}).then(t=>{if(t.ok)return t.json();throw"Error"}).then(t=>{let e="";t.forEach(t=>{let s;s=t.open?"open":"closed",e+=`\n\t\t\t\t<div class="col-8 mb-3">\n\t\t\t\t\t<div class="card issue ${s}">\n\t\t\t\t\t\t<h5 class="card-header id">ID: ${t.id}</h5>\n\t\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t\t\t<h5 class="card-title">${t.issue_title} (${s})</h5>\n\t\t\t\t\t\t\t<p class="card-text">${t.issue_text}</p>\n\t\t\t\t\t\t\t<p class="card-text">${t.status_text}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="card-footer text-muted">\n\t\t\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t\t\t<span class="fw-semibold">Created by:</span> ${t.created_by}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t\t\t<span class="fw-semibold">Assigned to:</span> ${t.assigned_to}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="row mb-2">\n\t\t\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t\t\t<span class="fw-semibold">Created on:</span> ${t.created_on}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t\t\t<span class="fw-semibold">Last updated:</span> ${t.updated_on}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t\t\t<div class="col">\n\t\t\t\t\t\t\t\t\t<form class="issue-form" method="put">\n\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="id" value="${t.id}">\n\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="open" value="false">\n\t\t\t\t\t\t\t\t\t\t<input type="submit" class="btn btn-dark" value="Close Issue">\n\t\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="col d-flex justify-content-end">\n\t\t\t\t\t\t\t\t\t<form class="issue-form" method="delete">\n\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="id" value="${t.id}">\n\t\t\t\t\t\t\t\t\t\t<input type="submit" class="btn btn-danger" value="Delete Issue">\n\t\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t`}),""==e&&(e='<p class="text-center">No issues yet.</p>'),document.querySelector("#issue-display").innerHTML=e}).catch(t=>{console.log(t)}),document.querySelector("#new-issue").addEventListener("submit",t=>{t.preventDefault(),t.target.setAttribute("action",s+"api/issues/"+e),fetch(n,{method:"POST",body:new URLSearchParams(new FormData(t.target))}).then(t=>{if(t.ok)return t.json();throw"Error"}).then(e=>{void 0===e.error&&t.target.reset(),window.location.reload()}).catch(t=>{console.log(t)})}),document.querySelector("#issue-display").addEventListener("submit",t=>{t.target.closest(".issue-form")&&(t.preventDefault(),fetch(n,{method:t.target.closest(".issue-form").getAttribute("method").toUpperCase(),body:new URLSearchParams(new FormData(t.target.closest(".issue-form")))}).then(t=>{if(t.ok)return t.json();throw"Error"}).then(t=>{alert(void 0!==t.error?t.error:t.result),window.location.reload()}).catch(t=>{console.log(t)}))})}});